# Folio 使い方ガイド

## 目次

1. [はじめに](#はじめに)
2. [基本的な使い方](#基本的な使い方)
3. [ワークフロー詳細](#ワークフロー詳細)
4. [ユーザー確認ゲート](#ユーザー確認ゲート)
5. [コマンド一覧](#コマンド一覧)
6. [出力とエクスポート](#出力とエクスポート)
7. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

FolioはClaude Codeのサブエージェント機能を活用したAI小説執筆ツールです。なろう/カクヨム向けに最適化されており、Episode（話）単位で執筆を進めます。

### 必要なもの

- Claude Code CLI
- Claude Max サブスクリプション（並列エージェント実行に必要）

---

## 基本的な使い方

### 1. 小説を始める

```
/folio <あなたのアイデア>
```

**例：**
```
/folio 宇宙飛行士が孤独な火星ミッション中にAIと心を通わせる物語
```

```
/folio 京都の古い喫茶店を舞台に、常連客たちの人生が交差するヒューマンドラマ
```

### 2. 入力のコツ

良いプロンプトには以下を含めると効果的です：

| 要素 | 例 |
|------|-----|
| ジャンル | SF、ミステリー、ファンタジー、恋愛 |
| 設定 | 宇宙船内、京都の喫茶店、異世界 |
| 主人公 | 宇宙飛行士、高校生、引退した刑事 |
| テーマ | 孤独と繋がり、成長、贖罪 |
| トーン | シリアス、コミカル、ノスタルジック |

**詳細なプロンプト例：**
```
/folio 【ジャンル】ハードSF【設定】2150年、火星への単独ミッション【主人公】35歳の宇宙飛行士、妻と幼い娘を地球に残している【テーマ】孤独からの解放と人間性の再発見【トーン】内省的で静かな語り口
```

### 3. 入力制限

- 最大5000文字まで
- 空の入力はエラーになります

---

## ワークフロー詳細

### Phase 0: Intake（構造化）

プロンプトを解析し、以下を抽出します：
- ジャンル、トーン、コアテーマ
- キャラクター一覧

**出力**: `workspace/current/idea.json`

### Phase 1: Paths（展開案生成）

3つの異なるアプローチで展開案を生成：

| Path | 方向性 | 特徴 |
|------|--------|------|
| A | 王道・安定 | 予測可能だが満足度の高い展開 |
| B | 意外性・挑戦的 | 読者の予想を裏切る構成 |
| C | キャラ深掘り | 内面描写重視、感情の機微 |

**出力**: `workspace/paths/path-{A,B,C}.json`

### Phase 2: Select（パス選択 + 規模選択）

3つのPathと4つの規模から選択します。

**規模オプション：**

| 規模 | 総文字数 | 章数 | 話数 | 1話あたり |
|------|----------|------|------|-----------|
| 短編 | 〜1万字 | 1章 | 3〜5話 | 2,000〜3,000字 |
| 中編 | 3万〜12万字 | 3〜5章 | 10〜40話 | 2,000〜4,000字 |
| 長編 | 8万〜12万字 | 5〜8章 | 25〜40話 | 2,000〜4,000字 |
| 連載 | 30万字〜 | 10章〜 | 100話〜 | 2,000〜4,000字 |

**選択例**: `A2`（パスA、中編）

### Phase 3: Design（キャラクター生成）

主要キャラクター（最大5人）のキャラクターシートを生成：
- 基本情報、行動原理
- 性格、外見、背景
- キャラクターアーク
- 関連キャラクター

**出力**: `output/characters/*.md`

キャラクター生成後、**確認ゲート**でユーザー承認を求めます。

### Phase 4: Loop（Episode単位の執筆ループ）

選択したPathに基づいて、**Episode（話）単位**で執筆を進めます：

```
Episode Draft生成 → Crew 8名評価 → 品質ゲート判定
  → [PASS: 次のEpisode / FAIL: 改稿]
```

**章の流れ：**
- **第一章**: Path選択の内容で直接開始
- **第二章以降**: 章開始前に流れ確認ゲート（3パターンから選択）

**章完了時**: ユーザー確認ゲートで承認を求めます。

### Phase 5: Assemble（最終仕上げ）

全章完了後、最終原稿を生成します。

---

## ユーザー確認ゲート

Folioは以下のタイミングでユーザー確認を求めます：

| ゲート | タイミング | 内容 |
|--------|----------|------|
| パス・規模選択 | Phase 2 | 3つのPath + 4つの規模から選択 |
| キャラクター確認 | Phase 3完了後 | キャラクターシートの承認 |
| 章の流れ選択 | 第二章以降の開始前 | 3パターンから流れを選択 |
| 章完了確認 | 各章完了時 | 章全体の承認、伏線状況確認 |
| 新キャラ確認 | 執筆中（必要時） | 新キャラクターの承認 |

---

## コマンド一覧

| コマンド | 説明 |
|----------|------|
| `/folio <プロンプト>` | 小説オーケストレーションを開始 |
| `/status` | 現在の進捗を表示 |
| `/export` | 原稿を `output/` に出力 |
| `/characters` | キャラクター一覧を表示 |
| `/foreshadowing` | 伏線の状況（open/resolved）を表示 |
| `/chapter-status` | 各章の確認状態を表示 |

### /status の表示例

```
── Folio Running ─────────────────────────────
 第1章「旅立ち」 │ 第3話「決意」
 Round 2 of 5 │ Avg Score: 7.3 (+1.1)

 完了: 2/15 話

 Plotter   ████████░░  done    7.2
 Persona   ████████░░  done    7.5
 Stylist   ██████░░░░  reviewing...
 Pacer     ░░░░░░░░░░  pending
──────────────────────────────────────────────
```

---

## 出力とエクスポート

### 出力構造

```
output/
├── characters/                    # キャラクターシート
│   ├── _index.md                  # 登場人物一覧
│   └── {キャラ名}.md
└── episodes/                      # 完成したEpisode
    ├── _index.md                  # 目次
    └── chapter_1/                 # 章ディレクトリ
        ├── episode_1.md
        ├── episode_2.md
        └── ...
```

### Episode ファイル形式

```markdown
---
話数: 3
タイトル: 決意
章: 第1章「旅立ち」
文字数: 3200
ステータス: 確定
最終スコア: 7.8
レビューラウンド: 3
---

# 第3話「決意」

（本文）

---
[← 前話](./episode_2.md) | [次話 →](./episode_4.md)

[目次に戻る](../_index.md)
```

### /export コマンド

全Episodeを結合した原稿を出力します：

```
/export
```

---

## 品質ゲート

### Episode Gate（話レベル）

| 基準 | 値 |
|------|-----|
| 全体平均スコア | 7.0以上 |
| 各評価軸 | 6.5以上 |
| クリティカル問題 | なし |
| 最大ラウンド | 5回 |
| 文字数 | 2,000〜4,000字 |

5ラウンドに達しても基準未達の場合、強制通過となります。

### Chapter Gate（章レベル）

- 話間の整合性チェック
- 章全体のペーシング確認
- 伏線追跡（張り/回収/持越し）
- ユーザー承認必須

---

## Crewエージェント

| エージェント | 役割 |
|-------------|------|
| Plotter | プロット構成、ドラフト生成 |
| Persona | キャラクター一貫性 |
| Stylist | 文章品質 |
| Pacer | ペーシング |
| Lens | 読者視点、クロスレビュー |
| Anchor | テーマ一貫性 |
| Voice | 会話品質 |
| Atlas | 世界観・設定 |

---

## トラブルシューティング

### 「入力が長すぎます」エラー

プロンプトは5000文字以内に収めてください。

### 進捗が止まったように見える

1. `/status` で現在の状態を確認
2. `awaiting_user: true` の場合、あなたの入力を待っています
3. エージェントが並列実行中の場合、完了まで待ってください

### 品質スコアが上がらない

5ラウンドに達すると強制通過します。強制通過した話には未解決の問題がコメントとして残ります。

---

## 次のステップ

- [README.md](../README.md) - プロジェクト概要
- [CLAUDE.md](../CLAUDE.md) - Deskのシステムプロンプト
