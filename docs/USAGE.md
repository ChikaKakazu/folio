# Folio 使い方ガイド

## 目次

1. [はじめに](#はじめに)
2. [基本的な使い方](#基本的な使い方)
3. [ワークフロー詳細](#ワークフロー詳細)
4. [Path選択のコツ](#path選択のコツ)
5. [進捗の確認](#進捗の確認)
6. [出力とエクスポート](#出力とエクスポート)
7. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

FolioはClaude Codeのサブエージェント機能を活用したAI小説執筆ツールです。あなたのアイデアを入力すると、複数のAIエージェントが協調して小説を執筆します。

### 必要なもの

- Claude Code CLI
- Claude Max サブスクリプション（並列エージェント実行に必要）

---

## 基本的な使い方

### 1. 小説を始める

```
/folio <あなたのアイデア>
```

**例：**
```
/folio 宇宙飛行士が孤独な火星ミッション中にAIと心を通わせる物語
```

```
/folio 京都の古い喫茶店を舞台に、常連客たちの人生が交差するヒューマンドラマ
```

```
/folio 記憶を失った少女が、自分の過去を追って日本各地を旅するミステリー
```

### 2. 入力のコツ

良いプロンプトには以下を含めると効果的です：

| 要素 | 例 |
|------|-----|
| ジャンル | SF、ミステリー、ファンタジー、恋愛 |
| 設定 | 宇宙船内、京都の喫茶店、異世界 |
| 主人公 | 宇宙飛行士、高校生、引退した刑事 |
| テーマ | 孤独と繋がり、成長、贖罪 |
| トーン | シリアス、コミカル、ノスタルジック |

**詳細なプロンプト例：**
```
/folio 【ジャンル】ハードSF【設定】2150年、火星への単独ミッション【主人公】35歳の宇宙飛行士、妻と幼い娘を地球に残している【テーマ】孤独からの解放と人間性の再発見【トーン】内省的で静かな語り口
```

### 3. 入力制限

- 最大5000文字まで
- 空の入力はエラーになります

---

## ワークフロー詳細

### Phase 0: Intake（構造化）

あなたのプロンプトを解析し、以下の要素を抽出します：
- ジャンル
- トーン
- スケール（短編/中編/長編）
- コアテーマ
- キャラクター一覧

**出力**: `workspace/current/idea.json`

### Phase 0.5: Character Generation

主要キャラクター（最大5人）のキャラクターシートを生成します：
- 外見
- 性格
- 背景
- キャラクターアーク
- 話し方の特徴
- 他キャラとの関係性

**出力**: `workspace/current/characters/*.json`

### Phase 1: Paths（展開案生成）

3つの異なるアプローチで展開案を生成します：

| Path | 方向性 | 特徴 |
|------|--------|------|
| A | 王道・安定 | 予測可能だが満足度の高い展開 |
| B | 意外性・挑戦的 | 読者の予想を裏切る構成 |
| C | キャラ深掘り | 内面描写重視、感情の機微 |

**出力**: `workspace/paths/path-{A,B,C}.json`

### Phase 2: Select（ユーザー選択）

3つのPathが提示されます。各Pathには以下が含まれます：
- アプローチの説明
- 章構成の概要
- 感情的な核（emotional core）
- 想定読者層

**あなたの選択をDeskに伝えてください。**

### Phase 4: Loop（執筆ループ）

選択したPathに基づいて、章ごとに以下のサイクルを実行します：

```
Draft生成 → Crew評価 → 品質ゲート判定 → [PASS: 次章 / FAIL: 改稿]
```

#### 品質ゲート基準

| 基準 | 値 |
|------|-----|
| 全体平均スコア | 7.0以上 |
| 各評価軸 | 6.5以上 |
| クリティカル問題 | なし |
| 最大ラウンド | 5回 |
| 最小改善幅 | 0.3 |

5ラウンドに達しても基準未達の場合、強制通過となります。

---

## Path選択のコツ

### Path A（王道）を選ぶ場合
- 初めてFolioを使う
- 安定した品質の作品が欲しい
- 幅広い読者に届けたい

### Path B（意外性）を選ぶ場合
- 実験的な作品を作りたい
- 予想外の展開を楽しみたい
- ジャンルの枠を超えたい

### Path C（キャラ深掘り）を選ぶ場合
- キャラクターの内面を重視
- 感情的な共感を大切にしたい
- 静かで深みのある物語を求める

---

## 進捗の確認

### /status コマンド

執筆中の進捗を確認できます：

```
/status
```

**表示例：**
```
── Folio Running ─────────────────────────────
 Chapter 1 │ Round 2 of 5 │ Avg Score: 7.3 (+1.1)

 Plotter   ████████░░  done    7.2
 Persona   ████████░░  done    7.5
 Stylist   ██████░░░░  reviewing...
 Pacer     ░░░░░░░░░░  pending
 Lens      ░░░░░░░░░░  pending
──────────────────────────────────────────────
```

### ステータスの意味

| ステータス | 意味 |
|-----------|------|
| pending | 待機中 |
| reviewing | 評価中 |
| done | 完了（スコア表示） |

---

## 出力とエクスポート

### /export コマンド

品質ゲートを通過した章を `output/` ディレクトリに出力します：

```
/export
```

### 出力形式

```
output/
├── manuscript.md        # 統合原稿
└── chapters/
    ├── ch01.md
    ├── ch02.md
    └── ...
```

---

## トラブルシューティング

### 「入力が長すぎます」エラー

プロンプトは5000文字以内に収めてください。要点を絞って簡潔に。

### 進捗が止まったように見える

1. `/status` で現在の状態を確認
2. `awaiting_user: true` の場合、あなたの入力を待っています
3. エージェントが並列実行中の場合、完了まで待ってください

### 品質スコアが上がらない

5ラウンドに達すると強制通過します。強制通過した章には未解決の問題がコメントとして残ります。

### Editorが終了してしまった

Phase 2（Path選択）では、Editorは意図的に終了します。選択結果を伝えると、Deskが再起動します。

---

## 高度な使い方

### workspace/current/ の直接確認

執筆中のデータを直接確認できます：

- `idea.json` - 構造化されたアイデア
- `selected_path.json` - 選択されたPath
- `state.json` - Editorの内部状態
- `progress.json` - 進捗表示用データ
- `characters/` - キャラクターシート
- `chapters/ch{N}/draft-{R}.md` - 章のドラフト
- `chapters/ch{N}/reviews/round-{R}/` - 評価結果

### 評価詳細の確認

各エージェントの評価は JSON 形式で保存されています：

```
workspace/current/chapters/ch01/reviews/round-01/plotter.json
```

評価には以下が含まれます：
- 各評価軸のスコア
- 問題点のリスト
- 具体的な修正提案

---

## 次のステップ

- [CLAUDE.md](../CLAUDE.md) - Deskのシステムプロンプトを読んでアーキテクチャを理解
- `prompts/editor.md` - Editorの詳細な動作を確認
- `prompts/crew/` - 各Crewエージェントの評価基準を確認
